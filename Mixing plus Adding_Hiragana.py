import re


# Part 1: Mixing verses..............................

from collections import defaultdict

def group_verses(text):
    # Use regular expression to find all matches of verse numbers and their texts
    pattern = re.compile(r'(\d+)([^\d]+)')
    matches = pattern.findall(text)
    
    # Create a dictionary to hold verses grouped by their number
    grouped_verses = defaultdict(list)
    
    # Iterate over the matches and group verses by number
    for number, verse in matches:
        grouped_verses[number].append(verse.strip())
    
    # Sort the dictionary by verse number
    sorted_verses = dict(sorted(grouped_verses.items(), key=lambda item: int(item[0])))
    
    # Combine grouped verses into a single string for each verse number
    combined_verses = []
    for number, verses in sorted_verses.items():
        # Add the first verse with its number
        combined_verses.append(f"{number}{verses[0]}")
        # Add the rest of the verses with a bullet
        combined_verses.extend([f"•{verse}" for verse in verses[1:]])
    
    return combined_verses

input_text = """

1「はっきり言(い)っておく。	羊(ひつじ)の囲(かこ)いに入(はい)るのに、門(もん)を通(とお)らないでほかの所(ところ)を乗(の)り越(こ)えて来(く)る者(もの)は、盗人(ぬすびと)であり、強盗(ごうとう)である。 2門(もん)から入(はい)る者(もの)が羊飼(ひつじか)いである。 3門番(もんばん)は羊飼(ひつじか)いには門(もん)を開(ひら)き、羊(ひつじ)はその声(こえ)を聞(き)き分(わ)ける。羊飼(ひつじか)いは自分(じぶん)の羊(ひつじ)の名(な)を呼(よ)んで連(つ)れ出(だ)す。 4自分(じぶん)の羊(ひつじ)をすべて連(つ)れ出(だ)すと、先頭(せんとう)に立(た)って行(い)く。羊(ひつじ)はその声(こえ)を知(し)っているので、ついて行(い)く。 5しかし、ほかの者(もの)には決(けっ)してついて行(い)かず、逃(に)げ去(さ)る。ほかの者(もの)たちの声(こえ)を知(し)らないからである。」 6イエスは、このたとえをファリサイ派(は)の人々(ひとびと)に話(はな)されたが、彼(かれ)らはその話(はなし)が何(なに)のことか分(わ)からなかった。
7イエスはまた言(い)われた。「はっきり言(い)っておく。わたしは羊(ひつじ)の門(もん)である。 8わたしより前(まえ)に来(き)た者(もの)は皆(みな)、盗人(ぬすびと)であり、強盗(ごうとう)である。しかし、羊(ひつじ)は彼(かれ)らの言(い)うことを聞(き)かなかった。 9わたしは門(もん)である。わたしを通(とお)って入(はい)る者(もの)は救(すく)われる。その人(ひと)は、門(もん)を出入(でい)りして牧草(ぼくそう)を見(み)つける。 10盗人(ぬすびと)が来(く)るのは、盗(ぬす)んだり、屠(ほふ)ったり、滅(ほろ)ぼしたりするためにほかならない。わたしが来(き)たのは、羊(ひつじ)が命(いのち)を受(う)けるため、しかも豊(ゆた)かに受(う)けるためである。 11わたしは良(よ)い羊飼(ひつじか)いである。良(よ)い羊飼(ひつじか)いは羊(ひつじ)のために命(いのち)を捨(す)てる。 12羊飼(ひつじか)いでなく、自分(じぶん)の羊(ひつじ)を持(も)たない雇(やと)い人(にん)は、狼(おおかみ)が来(く)るのを見(み)ると、羊(ひつじ)を置(お)き去(ざ)りにして逃(に)げる。――狼(おおかみ)は羊(ひつじ)を奪(うば)い、また追(お)い散(ち)らす。―― 13彼(かれ)は雇(やと)い人(にん)で、羊(ひつじ)のことを心(こころ)にかけていないからである。 14わたしは良(よ)い羊飼(ひつじか)いである。わたしは自分(じぶん)の羊(ひつじ)を知(し)っており、羊(ひつじ)もわたしを知(し)っている。 15それは、父(ちち)がわたしを知(し)っておられ、わたしが父(ちち)を知(し)っているのと同(おな)じである。わたしは羊(ひつじ)のために命(いのち)を捨(す)てる。 16わたしには、この囲(かこ)いに入(はい)っていないほかの羊(ひつじ)もいる。その羊(ひつじ)をも導(みちび)かなければならない。その羊(ひつじ)もわたしの声(こえ)を聞(き)き分(わ)ける。こうして、羊(ひつじ)は一人(ひとり)の羊飼(ひつじか)いに導(みちび)かれ、一(ひと)つの群(む)れになる。 17わたしは命(いのち)を、再(ふたた)び受(う)けるために、捨(す)てる。それゆえ、父(ちち)はわたしを愛(あい)してくださる。 18だれもわたしから命(いのち)を奪(うば)い取(と)ることはできない。わたしは自分(じぶん)でそれを捨(す)てる。わたしは命(いのち)を捨(す)てることもでき、それを再(ふたた)び受(う)けることもできる。これは、わたしが父(ちち)から受(う)けた掟(おきて)である。」
19この話(はなし)をめぐって、ユダヤ(ゆだや)人(じん)たちの間(あいだ)にまた対立(たいりつ)が生(しょう)じた。 20多(おお)くのユダヤ(ゆだや)人(じん)は言(い)った。「彼(かれ)は悪霊(あくりょう)に取(と)りつかれて、気(き)が変(へん)になっている。なぜ、あなたたちは彼(かれ)の言(い)うことに耳(みみ)を貸(か)すのか。」 21ほかの者(もの)たちは言(い)った。「悪霊(あくりょう)に取(と)りつかれた者(もの)は、こういうことは言(い)えない。悪霊(あくれい)に盲人(もうじん)の目(め)が開(あ)けられようか。」
22そのころ、エルサレムで神殿(しんでん)奉献(ほうけん)記念(きねん)祭(さい)が行(おこな)われた。冬(ふゆ)であった。 23イエスは、神殿(しんでん)の境内(けいだい)でソロモンの回廊(かいろう)を歩(ある)いておられた。 24すると、ユダヤ(ゆだや)人(じん)たちがイエスを取(と)り囲(かこ)んで言(い)った。「いつまで、わたしたちに気(き)をもませるのか。もしメシアなら、はっきりそう言(い)いなさい。」 25イエスは答(こた)えられた。「わたしは言(い)ったが、あなたたちは信(しん)じない。わたしが父(ちち)の名(な)によって行(おこな)う業(わざ)が、わたしについて証(あか)しをしている。 26しかし、あなたたちは信(しん)じない。わたしの羊(ひつじ)ではないからである。 27わたしの羊(ひつじ)はわたしの声(こえ)を聞(き)き分(わ)ける。わたしは彼(かれ)らを知(し)っており、彼(かれ)らはわたしに従(したが)う。 28わたしは彼(かれ)らに永遠(えいえん)の命(いのち)を与(あた)える。彼(かれ)らは決(けっ)して滅(ほろ)びず、だれも彼(かれ)らをわたしの手(て)から奪(うば)うことはできない。 29わたしの父(ちち)がわたしにくださったものは、すべてのものより偉大(いだい)であり、だれも父(ちち)の手(て)から奪(うば)うことはできない。 30わたしと父(ちち)とは一(ひと)つである。」
31ユダヤ人たちは、イエスを石(いし)で打(う)ち殺(ころ)そうとして、また石(いし)を取(と)り上(あ)げた。 32すると、イエスは言(い)われた。「わたしは、父(ちち)が与(あた)えてくださった多(おお)くの善業(ぜんごう)をあなたたちに示(しめ)した。その中(なか)のどの業(わざ)のために、石(いし)で打(う)ち殺(ころ)そうとするのか。」 33ユダヤ人たちは答(こた)えた。「善業(ぜんごう)のことで、石(いし)で打(う)ち殺(ころ)すのではない。神(かみ)を冒瀆(ぼうとく)したからだ。あなたは、人間(にんげん)なのに、自分(じぶん)を神(かみ)としているからだ。」 34そこで、イエスは言(い)われた。「あなたたちの律法(りっぽう)に、『わたしは言(い)う。あなたたちは神々(かみがみ)である』と書(か)いてあるではないか。 35神(かみ)の言葉(ことば)を受(う)けた人たちが、『神々(かみがみ)』と言(い)われている。そして、聖書(せいしょ)が廃(すた)れることはありえない。 36それなら、父(ちち)から聖(きよ)なる者(もの)とされて世(よ)に遣(つか)わされたわたしが、『わたしは神(かみ)の子(こ)である』と言(い)ったからとて、どうして『神(かみ)を冒瀆(ぼうとく)している』と言(い)うのか。 37もし、わたしが父(ちち)の業(わざ)を行(おこな)っていないのであれば、わたしを信(しん)じなくてもよい。 38しかし、行(おこな)っているのであれば、わたしを信(しん)じなくても、その業(わざ)を信(しん)じなさい。そうすれば、父(ちち)がわたしの内(うち)におられ、わたしが父(ちち)の内(うち)にいることを、あなたたちは知(し)り、また悟(さと)るだろう。」 39そこで、ユダヤ人たちはまたイエスを捕(とら)らえようとしたが、イエスは彼(かれ)らの手(て)を逃(に)げれて、去(さ)って行(い)かれた。 40イエスは、再(ふたた)びヨルダンの向(む)こう側(がわ)、ヨハネが最初(さいしょ)に洗礼(バプテスマ)を授(さず)けていた所(ところ)に行(い)って、そこに滞在(たいざい)された。 41多(おお)くの人(ひと)がイエスのもとに来(き)て言(い)った。「ヨハネは何(なに)のしるしも行(おこな)わなかったが、彼(かれ)がこの方(ほう)について話(はな)したことは、すべて本当(ほんとう)だった。」 42そこでは、多(おお)くの人(ひと)がイエスを信(しん)じた。


1 耶穌說：「我實實在在地告訴你們，不從門進羊圈而從別處爬進去的人就是賊，是強盜。 2 從門進去的才是羊的牧人， 3 看門的會給他開門，羊也聽他的聲音。他按名字叫自己的羊，把牠們領出來。 4 領出來之後，自己便走在前面，羊群也跟著他，因為羊認得他的聲音。 5 羊從不跟隨陌生人，見了陌生人就逃跑，因為牠們不認得陌生人的聲音。」

6 耶穌講了這個比喻，但聽的人都不明白祂的意思。 7 於是祂又說：「我實實在在地告訴你們，我就是羊的門。 8 在我以前來的，都是賊，是強盜，羊不聽從他們。 9 我就是門，從我進來的必定得救，並且會安然出入，找到草吃。 10 盜賊來，無非是要偷竊、殺害、毀壞。但我來是要羊得生命，並且得到豐盛的生命。

11 「我是好牧人，好牧人為羊捨命。 12 如果是僱工，不是牧人，羊也不是他的，狼一來，他必撇下羊逃命。狼就會抓住羊，把羊群驅散。 13 他逃走，因為他是僱工，並不在乎羊。 14 我是好牧人，我認識我的羊，我的羊也認識我， 15 正如父認識我，我也認識父，並且我為羊捨命。 16 我還有別的羊不在這羊圈裡，我必須領他們回來，他們也必聽我的聲音。這樣，我所有的羊將要合成一群，由一個牧人來帶領。 17 父愛我，因為我捨棄自己的生命，為了再得回生命。 18 沒有人能奪走我的生命，我是甘心捨棄的。我有權捨棄，也有權得回，這是我從父那裡得到的命令。」

19 猶太人因這番話又起了紛爭。 20 他們當中好些人說：「祂被鬼附身了！祂瘋了！何必聽祂的？」

21 又有些人說：「被鬼附身的人不會說這種話的，鬼能醫好瞎眼的人嗎？」


22 耶路撒冷慶祝修殿節的時候到了，是在冬天。 23 當耶穌走過聖殿的所羅門廊時， 24 一群猶太人圍著祂說：「你讓我們困惑、猜疑要到什麼時候呢？如果你是基督，就清楚地告訴我們吧！」

25 耶穌回答說：「我已經告訴你們了，你們卻不信。我奉我父的名所行的神蹟也為我做見證， 26 只是你們不肯相信，因為你們不是我的羊。 27 我的羊聽我的聲音，我也認識他們，他們也跟隨我。 28 我要賜他們永生，他們永不滅亡。沒有人能從我的手裡把他們搶走。 29 我父把羊賜給我，祂比萬物都大，沒有人能從祂手中把羊搶走。 30 我和父本為一。」

31 於是猶太人又拿起石頭要打祂。 32 耶穌就問他們：「我將許多從父而來的美善之事顯給你們看，你們為了哪一件事拿石頭打我呢？」

33 猶太人回答說：「我們不是因為你做的善事打你，而是因為你說了褻瀆的話，你是人，卻把自己當作上帝。」

34 耶穌說：「你們的律法書上不是寫著『我曾說你們都是神』嗎？ 35 聖經上的話是不能廢的，既然上帝稱那些承受祂道的人為神， 36 那麼我是父分別出來又差到世上來的，我說自己是上帝的兒子，難道是褻瀆嗎？ 37 如果我不做我父的事，你們不必信我。 38 但如果我做了，你們縱然不信我，也應該相信我所做的事，這樣你們就會知道、領悟父在我裡面，我也在父裡面。」

39 他們又要抓耶穌，但祂從他們手中逃脫了。

40 後來，耶穌到了約旦河東岸約翰從前施洗的地方，在那裡住下來。 41 許多人來到祂那裡。他們說：「雖然約翰沒有行過神蹟，可是約翰所說關於這人的事全是真的。」 42 在那裡許多人信了耶穌。



"""

grouped_verses = group_verses(input_text)



# Part 2: Adding Hiragana and font size function...................



# Define a function to transform text based on the specified rules
def transform_text(text):
    # Rule 1: Prepend "XXX" before any number
    text = re.sub(r'(\d+)', r'XXX\1', text)

    # Rule 3: Prepend "YYY" before any bullet symbol (•)
    text = text.replace('•', 'YYY•')

    # Rule 2: Replace Kanji expressions followed by content in parenthesis
    def replace_kanji(match):
        kanji_expression = match.group(1)
        content = match.group(2)
        return f'ZZZ{content}AAA{kanji_expression}BBB'

    # Apply Rule 2 within the content between a number and a bullet
    kanji_pattern = r'([\u4e00-\u9faf]+)\(([^)]+)\)'
    text = re.sub(kanji_pattern, replace_kanji, text)

    # Replace placeholders with the specified HTML content
    text = text.replace('XXX', '</div></div></div><div class="hierarchy-item"> <span class="toggle">➕</span>')
    text = text.replace('ZZZ', '<span class="hiragana" data-hiragana="')
    text = text.replace('AAA', '" onclick="showHiragana(this)">')
    text = text.replace('BBB', '</span>')
    text = text.replace('YYY', '<div class="sub-items"> <div class="hierarchy-item">')

    return text

# Example usage
input_text = ' '.join(grouped_verses)
output_text = transform_text(input_text)
print(f"Transformed text:\n{output_text}")

with open("C:/Users/pablo/OneDrive/Documentos/Bible/Bible Jap/Bible-Jap/MyFile.txt", "w", encoding='utf-8') as f:
    f.write(output_text)